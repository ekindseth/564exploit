# 564exploit
Evan and Stefans project

Hi, welcome to our 564 exploit. We decided to leverage an exploit in an enterprise messaging app called Inbit Messenger. It is vulnerable to a bufferoverflow that allowed for remote code execution.
Here is a link to the exploit on exploit-DB: https://www.exploit-db.com/exploits/51126

# Scenario
So, to set the scene, we decided to target a ski resort season pass holder database. In order to ski at many major resorts, there is an RFID gate system at each ski lift which allows 
season pass holders to scan their RFID cards and then proceed to the lift. Our cyber effect can access the database of these season pass holders, and add and remove users. 

# Initial setup 
We wrote a wrapper script called master.py which calls the exploit script with our initial payload. The initial payload downloads the implant onto the victim computer and then runs it. Once the implant is downloaded and running, it will constantly be listening for TCP connections on port 12000. We can then connect to it by running our command and control (C2) python script with the target IP and port as parameter. Now that we are connected, the fun stuff begins. 

# The Implant
The implant is the most interesting piece of code we wrote. It was written as a python script. However, we used two python libraries to compile it into an executable. The first was pyarmor, which obfuscates the script byte code. The second library was pyinstaller, which takes the obfuscated script and packs it into a windows exe. We had to make sure we compiled it with the correct flags so that it didn't spawn a windows command shell on runtime. The implant is also named "system_wifi_driver.exe" in order to make it less conspicuous to a user. The implant functions in the following manner: it listens on port 12000 for TCP connections from the command and control. It receives commands from the command and control, and parses them and returns the result. However, it should be noted that we set a 20 second timeout on the socket so if a command is not sent every 20 seconds the socket will timeout in order to avoid detectance. The implant has a few abilities: it can execute any shell commands, it can add, remove, and view all data in the target user database, and it can delete itself. The implant is also persistent, it schedule
